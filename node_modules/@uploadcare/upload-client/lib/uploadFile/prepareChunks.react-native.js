"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.prepareChunks = void 0;
var sliceChunk_1 = require("./sliceChunk");
/**
 * React-native hack for blob slicing
 *
 * We need to store references to sliced blobs to prevent source blob from
 * being deallocated until uploading complete. Access to deallocated blob
 * causes app crash.
 *
 * See https://github.com/uploadcare/uploadcare-upload-client/issues/306
 * and https://github.com/facebook/react-native/issues/27543
 */
function prepareChunks(file, fileSize, chunkSize) {
    var chunks = [];
    return function (index) {
        var chunk = sliceChunk_1.sliceChunk(file, index, fileSize, chunkSize);
        chunks.push(chunk);
        return chunk;
    };
}
exports.prepareChunks = prepareChunks;
